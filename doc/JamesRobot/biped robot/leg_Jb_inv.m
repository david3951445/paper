function invJb = leg_Jb_inv(th,L4,L5)
th1= th(1);
th2= th(2);
th3= th(3);
th4= th(4);
th5= th(5);
th6= th(6);
th7= th(7);
th8= th(8);
invJb =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -(- cos(th5)*sin(th1)*cos(th3)^2 + cos(th5)*sin(th1) + cos(th1)*sin(th3)*sin(th5))/(L5*cos(th3)^2*sin(th7)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -(sin(th1)*sin(th3)*sin(th5) - cos(th1)*cos(th5) + cos(th1)*cos(th3)^2*cos(th5))/(L5*cos(th3)^2*sin(th7)),                                                                                                     -(cos(th5)*sin(th3))/(L5*cos(th3)*sin(th7)),                                                                                                                                                                                     -1/(sin(th3)^2 - 1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             -(- cos(th6)*sin(th2)*cos(th4)^2 + cos(th6)*sin(th2) + cos(th2)*sin(th4)*sin(th6))/(L5*cos(th4)^2*sin(th8)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -(sin(th2)*sin(th4)*sin(th6) - cos(th2)*cos(th6) + cos(th2)*cos(th4)^2*cos(th6))/(L5*cos(th4)^2*sin(th8)),                                                                                                     -(cos(th6)*sin(th4))/(L5*cos(th4)*sin(th8)),                                                                                                                                                                                     -1/(sin(th4)^2 - 1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0,                                                     -(L4*cos(th1)*sin(th3) + L5*cos(th1)*cos(th7)*sin(th3) + L4*cos(th5)*sin(th1)*sin(th5) - L4*cos(th1)*cos(th5)^2*sin(th3) + L5*cos(th3)^2*sin(th1)*sin(th7) + L5*cos(th5)^2*sin(th1)*sin(th7) + L5*cos(th5)*cos(th7)*sin(th1)*sin(th5) - L5*cos(th1)*cos(th5)^2*cos(th7)*sin(th3) - L4*cos(th3)^2*cos(th5)*sin(th1)*sin(th5) - L5*cos(th3)^2*cos(th5)^2*sin(th1)*sin(th7) + L5*cos(th1)*cos(th5)*sin(th3)*sin(th5)*sin(th7) - L5*cos(th3)^2*cos(th5)*cos(th7)*sin(th1)*sin(th5))/(L5*cos(th3)*(L4*cos(th5)*sin(th7) - L5*sin(th5) + L5*cos(th7)^2*sin(th5) + L5*cos(th5)*cos(th7)*sin(th7))),                                                     -(L4*sin(th1)*sin(th3) - L4*cos(th1)*cos(th5)*sin(th5) + L5*cos(th7)*sin(th1)*sin(th3) - L5*cos(th1)*cos(th3)^2*sin(th7) - L5*cos(th1)*cos(th5)^2*sin(th7) - L4*cos(th5)^2*sin(th1)*sin(th3) - L5*cos(th1)*cos(th5)*cos(th7)*sin(th5) + L4*cos(th1)*cos(th3)^2*cos(th5)*sin(th5) - L5*cos(th5)^2*cos(th7)*sin(th1)*sin(th3) + L5*cos(th1)*cos(th3)^2*cos(th5)^2*sin(th7) + L5*cos(th5)*sin(th1)*sin(th3)*sin(th5)*sin(th7) + L5*cos(th1)*cos(th3)^2*cos(th5)*cos(th7)*sin(th5))/(L5*cos(th3)*(L4*cos(th5)*sin(th7) - L5*sin(th5) + L5*cos(th7)^2*sin(th5) + L5*cos(th5)*cos(th7)*sin(th7))),                                                                                                              -(sin(th3)*sin(th5))/(L5*sin(th7)),              (2*(- L5*cos(th5)*cos(th7)^2 + L5*sin(th5)*sin(th7)*cos(th7) + L5*cos(th5) + L4*sin(th5)*sin(th7)))/(cos(th3)*(L4*sin(th5 + th7) - L5*sin(th5) - L4*sin(th5 - th7) + L5*sin(th5 + 2*th7)));
                                                             -(L4*cos(th2)*sin(th4) + L5*cos(th2)*cos(th8)*sin(th4) + L4*cos(th6)*sin(th2)*sin(th6) - L4*cos(th2)*cos(th6)^2*sin(th4) + L5*cos(th4)^2*sin(th2)*sin(th8) + L5*cos(th6)^2*sin(th2)*sin(th8) + L5*cos(th6)*cos(th8)*sin(th2)*sin(th6) - L5*cos(th2)*cos(th6)^2*cos(th8)*sin(th4) - L4*cos(th4)^2*cos(th6)*sin(th2)*sin(th6) - L5*cos(th4)^2*cos(th6)^2*sin(th2)*sin(th8) + L5*cos(th2)*cos(th6)*sin(th4)*sin(th6)*sin(th8) - L5*cos(th4)^2*cos(th6)*cos(th8)*sin(th2)*sin(th6))/(L5*cos(th4)*(L4*cos(th6)*sin(th8) - L5*sin(th6) + L5*cos(th8)^2*sin(th6) + L5*cos(th6)*cos(th8)*sin(th8))),                                                     -(L4*sin(th2)*sin(th4) - L4*cos(th2)*cos(th6)*sin(th6) + L5*cos(th8)*sin(th2)*sin(th4) - L5*cos(th2)*cos(th4)^2*sin(th8) - L5*cos(th2)*cos(th6)^2*sin(th8) - L4*cos(th6)^2*sin(th2)*sin(th4) - L5*cos(th2)*cos(th6)*cos(th8)*sin(th6) + L4*cos(th2)*cos(th4)^2*cos(th6)*sin(th6) - L5*cos(th6)^2*cos(th8)*sin(th2)*sin(th4) + L5*cos(th2)*cos(th4)^2*cos(th6)^2*sin(th8) + L5*cos(th6)*sin(th2)*sin(th4)*sin(th6)*sin(th8) + L5*cos(th2)*cos(th4)^2*cos(th6)*cos(th8)*sin(th6))/(L5*cos(th4)*(L4*cos(th6)*sin(th8) - L5*sin(th6) + L5*cos(th8)^2*sin(th6) + L5*cos(th6)*cos(th8)*sin(th8))),                                                                                                              -(sin(th4)*sin(th6))/(L5*sin(th8)),              (2*(- L5*cos(th6)*cos(th8)^2 + L5*sin(th6)*sin(th8)*cos(th8) + L5*cos(th6) + L4*sin(th6)*sin(th8)))/(cos(th4)*(L4*sin(th6 + th8) - L5*sin(th6) - L4*sin(th6 - th8) + L5*sin(th6 + 2*th8))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                  -(L4*cos(th1)*cos(th3)^2*sin(th5) - L4*cos(th5)*sin(th1)*sin(th3) - L4*cos(th1)*sin(th5) + L5*cos(th1)*cos(th3)^2*cos(th5)*sin(th7) + L5*cos(th1)*cos(th3)^2*cos(th7)*sin(th5) + L4*cos(th3)^2*cos(th5)*sin(th1)*sin(th3) + L5*cos(th3)^2*cos(th5)*cos(th7)*sin(th1)*sin(th3) - L5*cos(th3)^2*sin(th1)*sin(th3)*sin(th5)*sin(th7))/(L4*L5*cos(th3)^2*sin(th7)),                                                                                                                                                                                                                                                                                  -(L4*cos(th1)*cos(th5)*sin(th3) - L4*sin(th1)*sin(th5) + L4*cos(th3)^2*sin(th1)*sin(th5) - L4*cos(th1)*cos(th3)^2*cos(th5)*sin(th3) + L5*cos(th3)^2*cos(th5)*sin(th1)*sin(th7) + L5*cos(th3)^2*cos(th7)*sin(th1)*sin(th5) - L5*cos(th1)*cos(th3)^2*cos(th5)*cos(th7)*sin(th3) + L5*cos(th1)*cos(th3)^2*sin(th3)*sin(th5)*sin(th7))/(L4*L5*cos(th3)^2*sin(th7)),            (L4*cos(th5) - L4*cos(th3)^2*cos(th5) - L5*cos(th3)^2*cos(th5)*cos(th7) + L5*cos(th3)^2*sin(th5)*sin(th7))/(L4*L5*cos(th3)*sin(th7)),                                                                                                                                                                               sin(th3)/(sin(th3)^2 - 1);
                                                                                                                                                                                                                                                                                          -(L4*cos(th2)*cos(th4)^2*sin(th6) - L4*cos(th6)*sin(th2)*sin(th4) - L4*cos(th2)*sin(th6) + L5*cos(th2)*cos(th4)^2*cos(th6)*sin(th8) + L5*cos(th2)*cos(th4)^2*cos(th8)*sin(th6) + L4*cos(th4)^2*cos(th6)*sin(th2)*sin(th4) + L5*cos(th4)^2*cos(th6)*cos(th8)*sin(th2)*sin(th4) - L5*cos(th4)^2*sin(th2)*sin(th4)*sin(th6)*sin(th8))/(L4*L5*cos(th4)^2*sin(th8)),                                                                                                                                                                                                                                                                                  -(L4*cos(th2)*cos(th6)*sin(th4) - L4*sin(th2)*sin(th6) + L4*cos(th4)^2*sin(th2)*sin(th6) - L4*cos(th2)*cos(th4)^2*cos(th6)*sin(th4) + L5*cos(th4)^2*cos(th6)*sin(th2)*sin(th8) + L5*cos(th4)^2*cos(th8)*sin(th2)*sin(th6) - L5*cos(th2)*cos(th4)^2*cos(th6)*cos(th8)*sin(th4) + L5*cos(th2)*cos(th4)^2*sin(th4)*sin(th6)*sin(th8))/(L4*L5*cos(th4)^2*sin(th8)),            (L4*cos(th6) - L4*cos(th4)^2*cos(th6) - L5*cos(th4)^2*cos(th6)*cos(th8) + L5*cos(th4)^2*sin(th6)*sin(th8))/(L4*L5*cos(th4)*sin(th8)),                                                                                                                                                                               sin(th4)/(sin(th4)^2 - 1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                       (L4*cos(th1)*sin(th5) + L5*cos(th1)*cos(th5)*sin(th7) + L5*cos(th1)*cos(th7)*sin(th5) + L4*cos(th5)*sin(th1)*sin(th3) + L5*cos(th5)*cos(th7)*sin(th1)*sin(th3) - L5*sin(th1)*sin(th3)*sin(th5)*sin(th7))/(L4*L5*sin(th7)),                                                                                                                                                                                                                                                                                                                                                                                                                       (L4*sin(th1)*sin(th5) - L4*cos(th1)*cos(th5)*sin(th3) + L5*cos(th5)*sin(th1)*sin(th7) + L5*cos(th7)*sin(th1)*sin(th5) - L5*cos(th1)*cos(th5)*cos(th7)*sin(th3) + L5*cos(th1)*sin(th3)*sin(th5)*sin(th7))/(L4*L5*sin(th7)),                                                                                   (cos(th3)*(L5*cos(th5 + th7) + L4*cos(th5)))/(L4*L5*sin(th7)),                                                                                                                                                                                                       0;
                                                                                                                                                                                                                                                                                                                                                                                                                               (L4*cos(th2)*sin(th6) + L5*cos(th2)*cos(th6)*sin(th8) + L5*cos(th2)*cos(th8)*sin(th6) + L4*cos(th6)*sin(th2)*sin(th4) + L5*cos(th6)*cos(th8)*sin(th2)*sin(th4) - L5*sin(th2)*sin(th4)*sin(th6)*sin(th8))/(L4*L5*sin(th8)),                                                                                                                                                                                                                                                                                                                                                                                                                       (L4*sin(th2)*sin(th6) - L4*cos(th2)*cos(th6)*sin(th4) + L5*cos(th6)*sin(th2)*sin(th8) + L5*cos(th8)*sin(th2)*sin(th6) - L5*cos(th2)*cos(th6)*cos(th8)*sin(th4) + L5*cos(th2)*sin(th4)*sin(th6)*sin(th8))/(L4*L5*sin(th8)),                                                                                   (cos(th4)*(L5*cos(th6 + th8) + L4*cos(th6)))/(L4*L5*sin(th8)),                                                                                                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                               0,                                                                                                                                                                                                       0];
end