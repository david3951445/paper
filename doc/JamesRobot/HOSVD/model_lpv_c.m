clc;clear;close all
load('model_para.mat');
addpath 'G:\我的雲端硬碟\畢業論文 進度\模擬\MATLAB\biped robot'
%% lpv
lpv = {...
    @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)-2000       @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)-2000        @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)-2000        @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)-2000        @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)Jt1_1(x)    @(x)Jt1_2(x)    @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)Jt2_1(x)    @(x)Jt2_2(x)    @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)Jt3_1(x)    @(x)Jt3_2(x)    @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)-2000       @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)Jt4_1(x)    @(x)Jt4_2(x)    @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)J_bar1_1(x) @(x)J_bar1_2(x) @(x)J_bar1_3(x) @(x)J_bar1_4(x) @(x)J_bar1_5(x) @(x)J_bar1_6(x) @(x)J_bar1_7(x) @(x)J_bar1_8(x) @(x)J_bar1_9(x) @(x)J_bar1_10(x) @(x)J_bar1_11(x) @(x)J_bar1_12(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)J_bar2_1(x) @(x)J_bar2_2(x) @(x)J_bar2_3(x) @(x)J_bar2_4(x) @(x)J_bar2_5(x) @(x)J_bar2_6(x) @(x)J_bar2_7(x) @(x)J_bar2_8(x) @(x)J_bar2_9(x) @(x)J_bar2_10(x) @(x)J_bar2_11(x) @(x)J_bar2_12(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je1_1(x)   @(x)Je1_2(x)   @(x)Je1_3(x)   @(x)Je1_4(x)   @(x)Je1_5(x)   @(x)Je1_6(x)   @(x)Je1_7(x)   @(x)Je1_8(x)   @(x)Je1_9(x)   @(x)Je1_10(x)  @(x)Je1_11(x)  @(x)Je1_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je2_1(x)   @(x)Je2_2(x)   @(x)Je2_3(x)   @(x)Je2_4(x)   @(x)Je2_5(x)   @(x)Je2_6(x)   @(x)Je2_7(x)   @(x)Je2_8(x)   @(x)Je2_9(x)   @(x)Je2_10(x)  @(x)Je2_11(x)  @(x)Je2_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je3_1(x)   @(x)Je3_3(x)   @(x)Je3_3(x)   @(x)Je3_4(x)   @(x)Je3_5(x)   @(x)Je3_6(x)   @(x)Je3_7(x)   @(x)Je3_8(x)   @(x)Je3_9(x)   @(x)Je3_10(x)  @(x)Je3_11(x)  @(x)Je3_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je4_1(x)   @(x)Je4_4(x)   @(x)Je4_3(x)   @(x)Je4_4(x)   @(x)Je4_5(x)   @(x)Je4_6(x)   @(x)Je4_7(x)   @(x)Je4_8(x)   @(x)Je4_9(x)   @(x)Je4_10(x)  @(x)Je4_11(x)  @(x)Je4_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je5_1(x)   @(x)Je5_5(x)   @(x)Je5_3(x)   @(x)Je5_4(x)   @(x)Je5_5(x)   @(x)Je5_6(x)   @(x)Je5_7(x)   @(x)Je5_8(x)   @(x)Je5_9(x)   @(x)Je5_10(x)  @(x)Je5_11(x)  @(x)Je5_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je6_1(x)   @(x)Je6_6(x)   @(x)Je6_3(x)   @(x)Je6_4(x)   @(x)Je6_5(x)   @(x)Je6_6(x)   @(x)Je6_7(x)   @(x)Je6_8(x)   @(x)Je6_9(x)   @(x)Je6_10(x)  @(x)Je6_11(x)  @(x)Je6_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je7_1(x)   @(x)Je7_7(x)   @(x)Je7_3(x)   @(x)Je7_4(x)   @(x)Je7_5(x)   @(x)Je7_6(x)   @(x)Je7_7(x)   @(x)Je7_8(x)   @(x)Je7_9(x)   @(x)Je7_10(x)  @(x)Je7_11(x)  @(x)Je7_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je8_1(x)   @(x)Je8_8(x)   @(x)Je8_3(x)   @(x)Je8_4(x)   @(x)Je8_5(x)   @(x)Je8_6(x)   @(x)Je8_7(x)   @(x)Je8_8(x)   @(x)Je8_9(x)   @(x)Je8_10(x)  @(x)Je8_11(x)  @(x)Je8_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je9_1(x)   @(x)Je9_9(x)   @(x)Je9_3(x)   @(x)Je9_4(x)   @(x)Je9_5(x)   @(x)Je9_6(x)   @(x)Je9_7(x)   @(x)Je9_8(x)   @(x)Je9_9(x)   @(x)Je9_10(x)  @(x)Je9_11(x)  @(x)Je9_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je10_1(x)  @(x)Je10_2(x)  @(x)Je10_3(x)  @(x)Je10_4(x)  @(x)Je10_5(x)  @(x)Je10_6(x)  @(x)Je10_7(x)  @(x)Je10_8(x)  @(x)Je10_9(x)  @(x)Je10_10(x) @(x)Je10_11(x) @(x)Je10_12(x) ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je11_1(x)  @(x)Je11_2(x)  @(x)Je11_3(x)  @(x)Je11_4(x)  @(x)Je11_5(x)  @(x)Je11_6(x)  @(x)Je11_7(x)  @(x)Je11_8(x)  @(x)Je11_9(x)  @(x)Je11_10(x) @(x)Je11_11(x) @(x)Je11_12(x) ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)Je12_1(x)  @(x)Je12_2(x)  @(x)Je12_3(x)  @(x)Je12_4(x)  @(x)Je12_5(x)  @(x)Je12_6(x)  @(x)Je12_7(x)  @(x)Je12_8(x)  @(x)Je12_9(x)  @(x)Je12_10(x) @(x)Je12_11(x) @(x)Je12_12(x) ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)-S5Jt1_1(x) @(x)-S5Jt1_2(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)GS1_1(x)   @(x)GS1_2(x)   @(x)GS1_3(x)   @(x)GS1_4(x)   @(x)GS1_5(x)   @(x)GS1_6(x)   @(x)GS1_7(x)   @(x)GS1_8(x)   @(x)GS1_9(x)   @(x)GS1_10(x)  @(x)GS1_11(x)  @(x)GS1_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)-S5Jt2_1(x) @(x)-S5Jt2_2(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)GS2_1(x)   @(x)GS2_2(x)   @(x)GS2_3(x)   @(x)GS2_4(x)   @(x)GS2_5(x)   @(x)GS2_6(x)   @(x)GS2_7(x)   @(x)GS2_8(x)   @(x)GS2_9(x)   @(x)GS2_10(x)  @(x)GS2_11(x)  @(x)GS2_12(x)  ;
    @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0           @(x)0            @(x)0            @(x)0            @(x)0          @(x)0          @(x)0          @(x)0          @(x)-S5Jt3_1(x) @(x)-S5Jt3_2(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)GS3_1(x)   @(x)GS3_2(x)   @(x)GS3_3(x)   @(x)GS3_4(x)   @(x)GS3_5(x)   @(x)GS3_6(x)   @(x)GS3_7(x)   @(x)GS3_8(x)   @(x)GS3_9(x)   @(x)GS3_10(x)  @(x)GS3_11(x)  @(x)GS3_12(x)  ;
    @(x)Gbar1_1(x)  @(x)Gbar1_2(x)  @(x)Gbar1_3(x)  @(x)Gbar1_4(x)  @(x)Gbar1_5(x)  @(x)Gbar1_6(x)  @(x)Gbar1_7(x)  @(x)Gbar1_8(x)  @(x)Gbar1_9(x)  @(x)Gbar1_10(x)  @(x)Gbar1_11(x)  @(x)Gbar1_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar2_1(x)  @(x)Gbar2_2(x)  @(x)Gbar2_3(x)  @(x)Gbar2_4(x)  @(x)Gbar2_5(x)  @(x)Gbar2_6(x)  @(x)Gbar2_7(x)  @(x)Gbar2_8(x)  @(x)Gbar2_9(x)  @(x)Gbar2_10(x)  @(x)Gbar2_11(x)  @(x)Gbar2_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar3_1(x)  @(x)Gbar3_2(x)  @(x)Gbar3_3(x)  @(x)Gbar3_4(x)  @(x)Gbar3_5(x)  @(x)Gbar3_6(x)  @(x)Gbar3_7(x)  @(x)Gbar3_8(x)  @(x)Gbar3_9(x)  @(x)Gbar3_10(x)  @(x)Gbar3_11(x)  @(x)Gbar3_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar4_1(x)  @(x)Gbar4_2(x)  @(x)Gbar4_3(x)  @(x)Gbar4_4(x)  @(x)Gbar4_5(x)  @(x)Gbar4_6(x)  @(x)Gbar4_7(x)  @(x)Gbar4_8(x)  @(x)Gbar4_9(x)  @(x)Gbar4_10(x)  @(x)Gbar4_11(x)  @(x)Gbar4_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar5_1(x)  @(x)Gbar5_2(x)  @(x)Gbar5_3(x)  @(x)Gbar5_4(x)  @(x)Gbar5_5(x)  @(x)Gbar5_6(x)  @(x)Gbar5_7(x)  @(x)Gbar5_8(x)  @(x)Gbar5_9(x)  @(x)Gbar5_10(x)  @(x)Gbar5_11(x)  @(x)Gbar5_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar6_1(x)  @(x)Gbar6_2(x)  @(x)Gbar6_3(x)  @(x)Gbar6_4(x)  @(x)Gbar6_5(x)  @(x)Gbar6_6(x)  @(x)Gbar6_7(x)  @(x)Gbar6_8(x)  @(x)Gbar6_9(x)  @(x)Gbar6_10(x)  @(x)Gbar6_11(x)  @(x)Gbar6_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar7_1(x)  @(x)Gbar7_2(x)  @(x)Gbar7_3(x)  @(x)Gbar7_4(x)  @(x)Gbar7_5(x)  @(x)Gbar7_6(x)  @(x)Gbar7_7(x)  @(x)Gbar7_8(x)  @(x)Gbar7_9(x)  @(x)Gbar7_10(x)  @(x)Gbar7_11(x)  @(x)Gbar7_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar8_1(x)  @(x)Gbar8_2(x)  @(x)Gbar8_3(x)  @(x)Gbar8_4(x)  @(x)Gbar8_5(x)  @(x)Gbar8_6(x)  @(x)Gbar8_7(x)  @(x)Gbar8_8(x)  @(x)Gbar8_9(x)  @(x)Gbar8_10(x)  @(x)Gbar8_11(x)  @(x)Gbar8_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar9_1(x)  @(x)Gbar9_2(x)  @(x)Gbar9_3(x)  @(x)Gbar9_4(x)  @(x)Gbar9_5(x)  @(x)Gbar9_6(x)  @(x)Gbar9_7(x)  @(x)Gbar9_8(x)  @(x)Gbar9_9(x)  @(x)Gbar9_10(x)  @(x)Gbar9_11(x)  @(x)Gbar9_12(x)  @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar10_1(x) @(x)Gbar10_2(x) @(x)Gbar10_3(x) @(x)Gbar10_4(x) @(x)Gbar10_5(x) @(x)Gbar10_6(x) @(x)Gbar10_7(x) @(x)Gbar10_8(x) @(x)Gbar10_9(x) @(x)Gbar10_10(x) @(x)Gbar10_11(x) @(x)Gbar10_12(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar11_1(x) @(x)Gbar11_2(x) @(x)Gbar11_3(x) @(x)Gbar11_4(x) @(x)Gbar11_5(x) @(x)Gbar11_6(x) @(x)Gbar11_7(x) @(x)Gbar11_8(x) @(x)Gbar11_9(x) @(x)Gbar11_10(x) @(x)Gbar11_11(x) @(x)Gbar11_12(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    @(x)Gbar12_1(x) @(x)Gbar12_2(x) @(x)Gbar12_3(x) @(x)Gbar12_4(x) @(x)Gbar12_5(x) @(x)Gbar12_6(x) @(x)Gbar12_7(x) @(x)Gbar12_8(x) @(x)Gbar12_9(x) @(x)Gbar12_10(x) @(x)Gbar12_11(x) @(x)Gbar12_12(x) @(x)0          @(x)0          @(x)0          @(x)0          @(x)0           @(x)0           @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          @(x)0          ;
    } ;
%% dep
dep = zeros([size(lpv) 11]);
% x = [phi0 phi1 w0 w1 phiBR vBR th vxr vyr phi1r wr];4 8 8 2 1 4
% x = [1    2    3  4  5     6   7  8   9   10    11];
%% x(1)
dep(13:16,17:18,1) = [...
    1,0;
    1,0;
    0,0;
    1,0
];

dep(17:18,1:12,1) = [...
    0,0,0,0,1,1,0,1,1,1,0,1;
    0,0,0,0,0,0,0,0,0,0,0,0
];

dep(31:33,17:18,1) = [...
    1,0;
    1,0;
    1,0
];

%% x(2)
dep(13:16,17:18,2) = [...
    1,0;
    1,0;
    0,0;
    1,0
];

dep(17:18,1:12,2) = [...
    0,0,0,0,1,1,0,1,1,1,0,1;
    0,0,0,0,0,0,0,0,0,0,0,0
];

dep(31:33,17:18,2) = [...
    1,0;
    1,0;
    1,0
];

%% x(3)
dep(17:18,1:12,3) = [...
    0,0,0,0,1,1,0,1,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0
];

%% x(4)
dep(17:18,1:12,4) = [...
    0,0,0,0,1,1,0,1,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0 
];

%% x(5)
dep(31:33,34:45,5) = [...
    1,1,0,0,0,0,0,0,0,0,0,0;
    1,1,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0
];
%% x(6)
dep(19:30,34:45,6) = [...
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0
];
%% x(7)
dep(19:30,34:45,7) = [...
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    1,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0
];

dep(42:45,1:12,7) = [...
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0
];

%% x(8)
dep(42:45,1:12,8) = [...
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0
];
%% x(9)
dep(42:45,1:12,9) = [...
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0
];
%% x(10)
dep(34:41,1:12,10) = [...
    0,0,0,0,1,1,0,0,1,1,0,0;
    0,0,0,0,1,1,0,0,1,1,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0
];
%% x(11)
dep(34:41,1:12,11) = [...
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,1,1,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0,0,0,0,0
];
%% domain & grid size
% sampling intervals for each parameter
domain = [-pi/2 pi/2;-pi pi;-0.1 0.1;-0.2 0.2;...
    -pi/2 pi/2;0 0.15; 1 8001; 0 0.2; 0 0.1; -pi/2 pi/2; -0.1 0.1
    ];
% grid size: number of grid points for each parameter
gridsize = [21 31 21 21 21 21 81 21 21 21 21 ];

%% TP transformation, same as:
%   [S U] = tptrans(lpv, dep, domain, gridsize, 'close');

% sampling
lpvdata = sampling_lpv(lpv, dep, domain, gridsize);
save('lpv_data', 'lpvdata');
%%
% hosvd
[S U sv tol] = hosvd_lpv(lpvdata, dep, gridsize, 0.001);

% generating tight polytopic representation
U = genhull(U, hull);
S = coretensor(U, lpvdata, dep);

% plot the results
plothull(U, domain);

% check model approximation error
[maxerr meanerr] = tperror(lpv, S, U, domain, 100);
disp('max and mean error:'); disp(maxerr); disp(meanerr);

% save('tora_data', 'S', 'U', 'n', 'domain', 'gridsize');
%%
% P = size(domain,1);
% A = cell(size(S,1:P));
% 
% for i1 = 1:size(S,1)
%     for i2 = 1:size(S,2)
%         for i3 = 1:size(S,3)
%             for i4 = 1:size(S,4)
%                 for i5 = 1:size(S,5)
%                     for i6 = 1:size(S,6)
%                         for i7 = 1:size(S,7)
%                             for i8 = 1:size(S,8)
%                                 for i9 = 1:size(S,9)
%                                     A{i1,i2,i3,i4,i5,i6,i7,i8,i9}(:,:) = S(i1,i2,i3,i4,i5,i6,i7,i8,i9,:,:);
%                                 end
%                             end
%                         end
%                     end
%                 end
%             end
%         end
%     end
% end
